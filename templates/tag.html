{% extends "base.html" %}

{% block title %}Posts tagged "{{ tag }}" | JoshAtticus Blog{% endblock %}

{% block content %}
    <div class="breadcrumb">
      <a href="/">Home</a> > <a href="/tags">Tags</a> > {{ tag }}
    </div>

    <h2 class="tag-header">
      Posts tagged "{{ tag }}" <span class="tag-count">({{ total_posts }})</span>
    </h2>

    <div class="post-list">
      {% for post in posts %}
      <article class="post-preview">
        <h2><a href="/posts/{{ post.slug }}">{{ post.title }}</a></h2>
        <div class="date">{{ post.date }}</div>
        <div class="post-content">
          <div class="summary">
            {{ post.summary }}
            {% if post.tags %}
            <div class="tags">
              {% for post_tag in post.tags %}
              <a href="/tags/{{ post_tag|lower|replace(' ', '-') }}" class="tag">{{ post_tag }}</a>
              {% endfor %}
            </div>
            {% endif %}
          </div>
          <div class="post-image">
            <img src="/{{ post.image }}" alt="{{ post.title }} featured image">
          </div>
        </div>
      </article>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if total_pages > 1 %}
    <div class="pagination">
      {% if page > 1 %}
      <a href="?page={{ page - 1 }}" class="pagination-btn">← Previous</a>
      {% else %}
      <span class="pagination-btn disabled">← Previous</span>
      {% endif %}

      <div class="pagination-numbers">
        {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
        <span class="pagination-number active">{{ p }}</span>
        {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %} <a href="?page={{ p }}"
          class="pagination-number">{{ p }}</a>
          {% elif p == page - 3 or p == page + 3 %}
          <span class="pagination-ellipsis">...</span>
          {% endif %}
          {% endfor %}
      </div>

      {% if page < total_pages %} <a href="?page={{ page + 1 }}" class="pagination-btn">Next →</a>
        {% else %}
        <span class="pagination-btn disabled">Next →</span>
        {% endif %}
    </div>
    {% endif %}

{% endblock %}